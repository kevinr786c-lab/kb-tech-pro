<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K.B Tech Pro | Activaci√≥n de Nodo M√©dico</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;500;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #0f172a; color: white; transition: 0.5s; }
        
        .preview-phone { width: 260px; height: 500px; border: 12px solid #1e293b; border-radius: 3rem; position: relative; overflow: hidden; background: #f8fafc; transition: 0.5s; box-shadow: 0 50px 100px -20px rgba(0,0,0,0.5); }
        .color-dot { width: 35px; height: 35px; border-radius: 50%; cursor: pointer; transition: 0.3s; border: 3px solid transparent; }
        .color-dot.active { border-color: white; transform: scale(1.2); box-shadow: 0 0 20px rgba(99,102,241,0.5); }
        .glass-card { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.1); }
        
        /* Animaci√≥n suave para los iconos de fondo del simulador */
        #prev-bg-icon { transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1); }
    </style>
</head>
<body class="p-4 md:p-8 flex items-center justify-center min-h-screen">

    <div class="max-w-6xl w-full grid grid-cols-1 lg:grid-cols-12 gap-12 items-center">
        
        <div class="lg:col-span-7 space-y-8">
            <header>
                <h1 class="text-5xl font-black italic tracking-tighter mb-2">K.B <span class="text-indigo-400 text-main-dynamic">TECH</span></h1>
                <p class="text-slate-400 text-xs uppercase tracking-[0.4em] font-bold">Plataforma de Gesti√≥n M√©dica de √âlite</p>
            </header>

            <form id="form-registro" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="space-y-2">
                        <label class="text-[10px] font-black uppercase text-slate-500 ml-4">Nombre del Especialista</label>
                        <input type="text" id="nombre" placeholder="Ej. Dr. Armando Guerra" class="w-full bg-slate-800/50 p-4 rounded-2xl border border-slate-700 outline-none focus:border-indigo-500 transition-all text-sm font-bold text-white">
                    </div>
                    <div class="space-y-2">
                        <label class="text-[10px] font-black uppercase text-slate-500 ml-4">Especialidad</label>
                        <select id="especialidad" onchange="cambiarCatalogo()" class="w-full bg-slate-800/50 p-4 rounded-2xl border border-slate-700 outline-none focus:border-indigo-500 text-sm font-bold text-white appearance-none">
                            <option value="Ginecolog√≠a">Ginecolog√≠a</option>
                            <option value="Odontolog√≠a">Odontolog√≠a</option>
                            <option value="Pediatr√≠a">Pediatr√≠a</option>
                            <option value="Cardiolog√≠a">Cardiolog√≠a</option>
                            <option value="Bienestar (Nutri/Psico)">Bienestar (Nutri/Psico)</option>
                            <option value="General">Medicina General</option>
                        </select>
                    </div>
                </div>

                <div class="glass-card p-8 rounded-[3rem] space-y-6">
                    <div class="flex justify-between items-center">
                        <p class="text-[10px] font-black uppercase text-indigo-400 tracking-[0.3em]">Personalizaci√≥n Atmosf√©rica</p>
                        <span id="theme-tag" class="text-[9px] font-black bg-white/10 px-3 py-1 rounded-full uppercase italic">Seleccione un estilo</span>
                    </div>
                    <div id="contenedor-colores" class="flex gap-6 flex-wrap">
                        </div>
                </div>

                <div class="flex items-center gap-6 p-6 bg-indigo-500/5 rounded-[2.5rem] border border-white/5">
                    <div class="flex-grow">
                        <p class="text-[9px] font-black uppercase text-indigo-400 mb-1">Plan de Suscripci√≥n Nodo Pro</p>
                        <p class="text-4xl font-black text-white">$1,599 <span class="text-xs text-slate-500 italic font-normal">MXN/mes</span></p>
                    </div>
                    <button type="button" onclick="procesarPago()" class="px-10 py-5 bg-indigo-500 text-white rounded-[2rem] font-black uppercase text-[10px] tracking-[0.2em] shadow-[0_20px_40px_rgba(99,102,241,0.3)] hover:bg-indigo-400 hover:scale-105 transition-all">Activar Nodo</button>
                </div>
            </form>
        </div>

        <div class="lg:col-span-5 flex flex-col items-center justify-center space-y-8">
            <div class="text-center">
                <p class="text-[10px] font-black uppercase text-slate-500 tracking-widest mb-2">Simulaci√≥n de Experiencia del Paciente</p>
                <p id="prev-desc" class="text-xs text-indigo-300 italic font-medium">"Cuidamos tu salud con elegancia."</p>
            </div>
            
            <div id="preview-box" class="preview-phone">
                <div id="prev-bg-icon" class="absolute top-10 right-[-40px] text-[15rem] opacity-10 pointer-events-none select-none">üå∏</div>
                
                <div class="p-8 text-slate-800 space-y-8 relative h-full flex flex-col justify-center bg-white/90">
                    <div class="text-center space-y-2">
                        <div id="prev-icon" class="text-5xl mb-4">üè•</div>
                        <div class="h-5 w-40 bg-slate-200 rounded-full mx-auto"></div>
                        <div class="h-2 w-24 bg-slate-100 rounded-full mx-auto"></div>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="h-12 w-full bg-white rounded-2xl border-2 border-slate-50 shadow-sm"></div>
                        <div class="grid grid-cols-2 gap-3">
                            <div class="h-12 w-full bg-white rounded-2xl border-2 border-slate-50 shadow-sm"></div>
                            <div class="h-12 w-full bg-white rounded-2xl border-2 border-slate-50 shadow-sm"></div>
                        </div>
                    </div>

                    <div id="prev-button" class="h-14 w-full rounded-[1.5rem] shadow-xl transition-all duration-500"></div>
                    
                    <div class="text-center pt-4">
                        <p class="text-[8px] font-black text-slate-300 uppercase">Powered by K.B Tech Solutions</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const URL_DB = "https://dgatsbnqgplalxwewpvs.supabase.co"; 
        const KEY_DB = "sb_publishable_qXj4L3x_s2sP3-FFQpIOhA_GXP0qX8i"; 

       const CATALOGO = {
    "Ginecolog√≠a": [
        { id: 2, color: "#f43f5e", icon: "üå∏", bg: "üå∏", desc: "Rose Quartz: Delicadeza y confianza absoluta.", tag: "Floral" },
        { id: 5, color: "#8b5cf6", icon: "üîÆ", bg: "‚ú®", desc: "Lavender Silk: Sofisticaci√≥n y calma boutique.", tag: "Boutique" },
        { id: 2, color: "#fb7185", icon: "üå∑", bg: "üéÄ", desc: "Pink Velvet: Suavidad y atenci√≥n prenatal.", tag: "Maternal" },
        { id: 3, color: "#059669", icon: "üçÉ", bg: "üåø", desc: "Nature Essence: Salud femenina org√°nica.", tag: "Org√°nico" },
        { id: 4, color: "#1e293b", icon: "üíé", bg: "üõ°Ô∏è", desc: "Premium Care: Discreci√≥n de alta gama.", tag: "√âlite" }
    ],
    "Odontolog√≠a": [
        { id: 1, color: "#0ea5e9", icon: "üíé", bg: "ü¶∑", desc: "Arctic Bright: Limpieza extrema y tecnolog√≠a.", tag: "Cl√≠nico" },
        { id: 3, color: "#10b981", icon: "üåø", bg: "üçÉ", desc: "Emerald Fresh: Frescura y salud dental.", tag: "Org√°nico" },
        { id: 1, color: "#22d3ee", icon: "‚ùÑÔ∏è", bg: "‚ú®", desc: "Ice Smile: Est√©tica y blanqueamiento.", tag: "Est√©tico" },
        { id: 4, color: "#1e3a8a", icon: "üõ°Ô∏è", bg: "ü¶æ", desc: "Titanium Pro: Cirug√≠a e implantes.", tag: "Cirug√≠a" },
        { id: 1, color: "#6366f1", icon: "‚ö°", bg: "üß¨", desc: "Digital Dentist: Innovaci√≥n 3D.", tag: "Tech" }
    ],
    "Pediatr√≠a": [
        { id: 2, color: "#fb923c", icon: "üß∏", bg: "üéà", desc: "Sunny Kids: Un entorno alegre y sin miedo.", tag: "Infantil" },
        { id: 1, color: "#38bdf8", icon: "üöÄ", bg: "‚òÅÔ∏è", desc: "Sky Dreams: Confianza y juego.", tag: "L√∫dico" },
        { id: 3, color: "#4ade80", icon: "ü¶ñ", bg: "üå≥", desc: "Dino Jungle: Aventura en el consultorio.", tag: "Aventura" },
        { id: 2, color: "#f472b6", icon: "üç≠", bg: "‚ú®", desc: "Candy Health: Dulzura y cuidado.", tag: "Tierno" },
        { id: 5, color: "#818cf8", icon: "üåô", bg: "‚≠ê", desc: "Starry Night: Calma para los m√°s peque√±os.", tag: "Paz" }
    ],
    "Cardiolog√≠a": [
        { id: 4, color: "#e11d48", icon: "‚ù§Ô∏è", bg: "üìà", desc: "Vital Pulse: Alta tecnolog√≠a card√≠aca.", tag: "Precisi√≥n" },
        { id: 4, color: "#1e293b", icon: "‚ö°", bg: "üß¨", desc: "Tech Heart: Seriedad y vanguardia.", tag: "Digital" },
        { id: 1, color: "#0284c7", icon: "üåä", bg: "‚ùÑÔ∏è", desc: "Flow System: Circulaci√≥n y salud.", tag: "Vascular" },
        { id: 4, color: "#9f1239", icon: "ü©∏", bg: "üíâ", desc: "Deep Crimson: Especialidad en sangre.", tag: "Hematolog√≠a" },
        { id: 1, color: "#4f46e5", icon: "üõ∞Ô∏è", bg: "üì°", desc: "Cyber Cardio: Monitoreo remoto Pro.", tag: "Remoto" }
    ],
    "Bienestar (Nutri/Psico)": [
        { id: 3, color: "#059669", icon: "üßò‚Äç‚ôÇÔ∏è", bg: "üçÉ", desc: "Zen Leaf: Equilibrio y paz mental.", tag: "Hol√≠stico" },
        { id: 5, color: "#a855f7", icon: "üß†", bg: "‚ú®", desc: "Mind Flow: Crecimiento seguro.", tag: "Mental" },
        { id: 3, color: "#fbbf24", icon: "üçé", bg: "‚òÄÔ∏è", desc: "Vital Food: Nutrici√≥n energ√©tica.", tag: "Nutrici√≥n" },
        { id: 1, color: "#0ea5e9", icon: "üåä", bg: "üíß", desc: "Deep Therapy: Inmersi√≥n emocional.", tag: "Terapia" },
        { id: 3, color: "#10b981", icon: "ü•ë", bg: "ü•ó", desc: "Clean Eating: Estilo de vida fit.", tag: "Fitness" }
    ],
    "General": [
        { id: 4, color: "#1e3a8a", icon: "‚öñÔ∏è", bg: "üõ°Ô∏è", desc: "Deep Ocean: Autoridad m√©dica.", tag: "S√≥lido" },
        { id: 1, color: "#6366f1", icon: "üè•", bg: "üß¨", desc: "Tech Navy: Innovaci√≥n digital.", tag: "Moderno" },
        { id: 3, color: "#10b981", icon: "ü©∫", bg: "üè•", desc: "Clinic Green: Salud primaria.", tag: "B√°sico" },
        { id: 2, color: "#be123c", icon: "üöë", bg: "üö®", desc: "Urgency Red: Atenci√≥n inmediata.", tag: "Urgencias" },
        { id: 5, color: "#4338ca", icon: "üè¢", bg: "üè¨", desc: "City Medical: Red hospitalaria.", tag: "Corporativo" }
    ]
};
        let currentSelection = { template_id: 2, color: "#f43f5e" };

        function cambiarCatalogo() {
            const esp = document.getElementById('especialidad').value;
            const contenedor = document.getElementById('contenedor-colores');
            const temas = CATALOGO[esp] || CATALOGO["General"];
            
            contenedor.innerHTML = "";
            temas.forEach((t, index) => {
                const dot = document.createElement('div');
                dot.className = `color-dot ${index === 0 ? 'active' : ''}`;
                dot.style.backgroundColor = t.color;
                dot.onclick = () => actualizarSimulador(t, dot);
                contenedor.appendChild(dot);
                if(index === 0) actualizarSimulador(t, dot);
            });
        }

        function actualizarSimulador(t, el) {
            document.querySelectorAll('.color-dot').forEach(d => d.classList.remove('active'));
            el.classList.add('active');
            
            currentSelection = { template_id: t.id, color: t.color };
            
            // Efectos Visuales
            document.getElementById('prev-button').style.backgroundColor = t.color;
            document.getElementById('prev-icon').innerText = t.icon;
            document.getElementById('prev-bg-icon').innerText = t.bg;
            document.getElementById('prev-desc').innerText = t.desc;
            document.getElementById('theme-tag').innerText = t.tag;
            document.getElementById('theme-tag').style.color = t.color;
            
            // Brillo din√°mico
            document.getElementById('preview-box').style.boxShadow = `0 40px 100px -20px ${t.color}44`;
            
            // Actualizar color de la marca
            document.querySelectorAll('.text-main-dynamic').forEach(el => el.style.color = t.color);
        }

        async function procesarPago() {
            const nombre = document.getElementById('nombre').value;
            if(!nombre) return alert("Por favor, ingrese el nombre del m√©dico.");
            
            const btn = event.target;
            btn.innerText = "PROCESANDO ACTIVACI√ìN...";
            btn.disabled = true;

            const datos = {
                nombre_doctor: nombre,
                especialidad: document.getElementById('especialidad').value,
                template_id: currentSelection.template_id,
                plan: 'Dominio',
                email: nombre.toLowerCase().split(' ').join('.') + "@kbtech.com"
            };

            try {
                const res = await fetch(`${URL_DB}/rest/v1/Perfiles_Medicos`, {
                    method: 'POST',
                    headers: { 'apikey': KEY_DB, 'Authorization': `Bearer ${KEY_DB}`, 'Content-Type': 'application/json', 'Prefer': 'return=representation' },
                    body: JSON.stringify(datos)
                });

                if(res.ok) {
                    const data = await res.json();
                    alert("¬°NODO ACTIVADO EXITOSAMENTE!\nBienvenido a la red K.B Tech Pro.");
                    window.location.href = `app.html?id=${data[0].id}`;
                } else {
                    throw new Error("Error en servidor");
                }
            } catch(e) {
                alert("Hubo un problema. Intente con otro nombre.");
                btn.innerText = "Activar Nodo";
                btn.disabled = false;
            }
        }

        // Iniciar con Ginecolog√≠a por defecto
        cambiarCatalogo();
    </script>
</body>
</html>
