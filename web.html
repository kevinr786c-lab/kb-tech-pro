<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SITIO WEB PROFESIONAL | K.B TECH</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@200;500;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #fafafa; color: #0f172a; }
        :root { --main: #6366f1; } 

        .glass-card { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(30px); border: 1px solid rgba(255, 255, 255, 0.7); box-shadow: 0 40px 100px -20px rgba(0,0,0,0.05); }
        .btn-agendar { width: 100%; border-radius: 1.5rem; background: var(--main); color: white; font-weight: 800; text-transform: uppercase; letter-spacing: 0.1em; transition: 0.4s; box-shadow: 0 20px 40px -10px var(--main); }
        .btn-agendar:hover { transform: translateY(-5px); filter: brightness(1.1); }
        
        .badge-verificado { background: var(--main); color: white; padding: 4px 12px; border-radius: 99px; font-size: 8px; font-weight: 900; letter-spacing: 2px; text-transform: uppercase; }
        .gemini-star { color: var(--main); animation: pulse 3s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4 md:p-10">

    <div class="max-w-3xl w-full glass-card p-12 md:p-20 rounded-[4rem] relative overflow-hidden text-center">
        <div class="absolute -top-24 -right-24 w-64 h-64 bg-indigo-500/5 rounded-full blur-3xl"></div>
        
        <header class="mb-12">
            <div id="doc-icon" class="text-7xl mb-6">ü©∫</div>
            <div id="badge-container" class="mb-4"></div>
            <h1 id="doc-name" class="text-4xl md:text-5xl font-black text-slate-900 tracking-tighter uppercase italic leading-none">---</h1>
            <p id="doc-esp" class="text-xs font-bold text-slate-400 uppercase tracking-[0.5em] italic mt-4">Sincronizando Nodo...</p>
        </header>

        <section class="space-y-8 mb-16">
            <div class="inline-block px-6 py-2 bg-slate-100 rounded-2xl text-[10px] font-black uppercase tracking-widest text-slate-500">Sobre el Especialista</div>
            <p id="doc-bio" class="text-lg md:text-xl text-slate-600 font-medium leading-relaxed italic px-4 md:px-12 opacity-0 transition-opacity duration-1000">Cargando...</p>
        </section>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-12">
            <div class="p-6 bg-slate-50 rounded-[2.5rem] border border-slate-100">
                <p class="text-[9px] font-black uppercase text-slate-400 mb-2">C√©dula Profesional</p>
                <p id="doc-cedula" class="font-bold text-slate-800 tracking-widest uppercase">---</p>
            </div>
            <div class="p-6 bg-slate-50 rounded-[2.5rem] border border-slate-100">
                <p class="text-[9px] font-black uppercase text-slate-400 mb-2">Registro Sanitario</p>
                <p id="doc-cofepris" class="font-bold text-slate-800 tracking-widest uppercase">---</p>
            </div>
        </div>

        <footer class="space-y-8">
            <button onclick="irAAgendar()" class="btn-agendar py-6 text-xs shadow-2xl">üìÖ Agendar Cita con el Especialista</button>
            <div class="pt-8 border-t border-slate-100">
                <span class="gemini-star text-sm">‚ú¶</span>
                <p class="text-[8px] font-black text-slate-300 uppercase tracking-[0.8em] mt-3">Gemini Engine ‚ú¶ K.B Tech Solutions</p>
            </div>
        </footer>
    </div>

    <script>
        const URL_DB = "https://dgatsbnqgplalxwewpvs.supabase.co";
        const KEY_DB = "sb_publishable_qXj4L3x_s2sP3-FFQpIOhA_GXP0qX8i";
        const docId = new URLSearchParams(window.location.search).get('id')?.trim();

        const CATALOGO_COLORES = {
            "Ginecolog√≠a": "#f43f5e", "Pediatr√≠a": "#fb923c", "Odontolog√≠a": "#0ea5e9", "Cardiolog√≠a": "#e11d48", "General": "#6366f1"
        };

        async function initWeb() {
            if(!docId) return alert("Error de Nodo.");
            const res = await fetch(`${URL_DB}/rest/v1/Perfiles_Medicos?id=eq.${docId}`, { headers: {'apikey': KEY_DB, 'Authorization': `Bearer ${KEY_DB}`} });
            const data = await res.json();
            
            if(data[0]) {
                const doc = data[0];
                const color = CATALOGO_COLORES[doc.especialidad] || "#6366f1";
                document.documentElement.style.setProperty('--main', color);
                
                if(doc.plan === "Dominio" || doc.plan === "Corporativo") {
                    document.getElementById('badge-container').innerHTML = `<span class="badge-verificado">M√©dico √âlite Verificado</span>`;
                }

                document.getElementById('doc-name').innerText = "Dr. " + doc.nombre_doctor;
                document.getElementById('doc-esp').innerText = doc.especialidad + " | Sucursal Digital";
                document.getElementById('doc-cedula').innerText = doc.cedula || "No registrada";
                document.getElementById('doc-cofepris').innerText = doc.aviso_cofepris || "En tr√°mite";
                
                const bioEl = document.getElementById('doc-bio');
                bioEl.innerText = doc.biografia || "Cuidando de tu salud con tecnolog√≠a de vanguardia.";
                bioEl.style.opacity = "1";
            }
        }

        function irAAgendar() { window.location.href = `agendar.html?id=${docId}`; }
        initWeb();
    </script>
</body>
</html>
